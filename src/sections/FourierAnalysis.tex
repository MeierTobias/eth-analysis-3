\section{Fourier Analysis}

\subsection{Periodicity}
A function $f(x)$ is called periodic if it is defined for “most” $x \in \mathbb{R} $ and if there is a positive real number $p \in R, p > 0$ such that $f(x) = f(x+p)$ for all $x$.
\begin{align*}
    f(t+p)=f(t),\quad                                                  & p>0             \\
    \sin\biggl( \underbrace{\frac{2\pi}{L}}_{\frac{2\pi}{p}}nt \biggr) & \rightarrow p=L \\
\end{align*}
\subsubsection{Properties of Periodic Functions}
\textbf{Periodicity}\\
Let $f(x)=f(x+P),\; g(x)=g(x+Q),\; h(x)=h(x+Q)$ be periodic functions.
\begin{enumerate}
    \item $f(x+nP)=f(x),\; n\in\mathbb{Z}$
    \item $f$ is $nP$ periodic too
    \item $f(a\cdot x)$ is $\frac{P}{a}$ periodic, $a \in \mathbb{R}$
    \item $a\cdot g(x)+b\cdot h(x)=a\cdot g(x+Q)+b\cdot h(x+Q)$ \\is $Q$ periodic, $a, b \in \mathbb{R}$
    \item $f(x+P)+g(x+Q)$ is periodic for the LCM (KGV) of $P$ and $Q$\\
          - the LCM is called fundamental period \\
          - the sum is only periodic if $\frac{P}{Q}\in \mathbb{Q}$
    \item if $f'(x)=f'(x+P)$ then $f(x)=f(x+P)$
\end{enumerate}
\textbf{Boundedness}\\
Let $f(x)$ be a function.
\begin{enumerate}
    \item if $f$ is $periodic$ and $continuous$: $f$ is $bounded$
    \item if $f$ is $periodic$ and $smooth$: $f$ and $f^{(n)}$ are $bounded$\\
          - smooth means no kinks ("Knicks"), meaning it is infinitely differentiable\\
          - if $f$ or one of its derivatives is not bounded, we know that $f$ is either not periodic or not smooth.
\end{enumerate}

\begin{examplesection}[Example of periodic functions]
    \begin{gather*}
        f(x) = \cos(3x) \qquad g(x) = \cos(4x) \\
        h(x) = f(x) + g(x) \\\\
        f(x) \text{ is } \frac{2\pi}{3}=P_1 \text{ periodic} \\
        g(x) \text{ is } \frac{2\pi}{4}=P_2 \text{ periodic} \\
        h(x) \text{ is LCM} (P_1, P_2)=P \text{ periodic} \\
        P=\text{LCM}(\frac{2\pi}{3}, \frac{2\pi}{4}) = \text{LCM}(4,3)\cdot\frac{\pi}{6} = \frac{12}{6}\pi = 2\pi
    \end{gather*}
\end{examplesection}

\subsection{Trigonometric System}
The collection
\begin{equation*}
    \left\{\sin\left(\frac{n\pi}Lx\right),\cos\left(\frac{n\pi}Lx\right):n\in\mathbb{Z},n\geq0\right\}
\end{equation*}
is called the $trigonometric$ $system$. The functions in the trigonometric system are $2L$ periodic. A series constructed from these functions is $2L$ periodic too if it converges.
\subsubsection{Orthogonality Properties}
\begin{align*}
    \int_{-L}^L\cos\left(\frac{n\pi}Lx\right)\cos\left(\frac{m\pi}Lx\right)dx=\begin{cases}0&n\neq m\\L&n=m\neq0\\2L&n=m=0.\end{cases} \\
    \int_{-L}^L\sin\left(\frac{n\pi}Lx\right)\sin\left(\frac{m\pi}Lx\right)dx=\begin{cases}0&n\neq m\\L&n=m\neq0.\end{cases}           \\
    \int_{-L}^L\cos\left(\frac{n\pi}Lx\right)\sin\left(\frac{m\pi}Lx\right)dx=0,\text{ for every }n,m.
\end{align*}
\subsection{Fourier Series}
For the Fourier series to exist and for it to converge to $f(t)$, $f(t)$ has to be defined and $2L$-periodic on $[-L,L]$.
For every discontinuity, the \textbf{Dirichlet Theorem} has to hold. If a function $f(t)$ has only a discrete set of discontinuities and the Dirichlet Theorem holds for these points, $f(t)$ is called well behaved. $a_0,a_n,b_b\in \mathbb{R}$
\begin{align*}
    f(x)  & =a_0+\sum_{n=1}^\infty\left(a_n\cos\left(\frac{n\pi}Lx\right)+b_n\sin\left(\frac{n\pi}Lx\right)\right) \\ \\
    a_{0} & =\frac{1}{2L}\int_{-L}^{L}f(x)dx                                                                       \\ \\
    a_{m} & =\frac{1}{L}\int_{-L}^{L}f(x)\cos\left(\frac{m\pi}{L}x\right)dx,\text{ if }m>0                         \\ \\
    b_{m} & =\frac{1}{L}\int_{-L}^{L}f(x)\sin\left(\frac{m\pi}{L}x\right)dx,\text{ if }m>0
\end{align*}
\subsubsection{Dirichlet Theorem - Convergenve}
For discontinuities $f(x^-)\neq f(x^+)$ the fourier series converges to:
\begin{align*}
    F(x_0) & =\frac12(f(x_0^-)+f(x_0^+))
\end{align*}

\subsubsection{Even FS}
Functions are even if $f(x)=f(-x)$ and due to symmetry:
\begin{align*}
    \int_{-L}^{L}g(x)dx=2\int_0^{L}g(x)dx
\end{align*}
\textbf{Fourier series} for even functions:
\begin{align*}
    f(x)  & =a_0+\sum_{n=1}^{\infty}a_n\cos\left(\frac{n\pi}{L}x\right) \\ \\
    a_{0} & =\frac{1}{L}\int_{0}^{L}f(x)dx                              \\
    a_{n} & =\frac2L\int_0^{L}f(x)\cos\left(\frac{n\pi}Lx\right)dx      \\
    b_{n} & =0
\end{align*}
\begin{align*}
    f(a\cdot x)=\frac1a\intop_0^\infty A(\frac\omega a)\cdot \cos(\omega x)d\omega
\end{align*}
\subsubsection{Odd FS}
Functions are odd if $f(x)=-f(-x)$ and due to symmetry:
\begin{align*}
    \int_{-L}^L g(x)dx=0
\end{align*}
\textbf{Fourier series} for odd functions:
\begin{align*}
    f(x) & =\sum_{n=1}^\infty b_n\sin\left(\frac{n\pi}Lx\right)          \\ \\
    a_0  & = a_n = 0                                                     \\
    b_n  & =\dfrac{2}{L}\int_0^L f(x)\sin\left(\dfrac{n\pi}{L}x\right)dx
\end{align*}

\subsubsection{Properties of Even and Odd Functions}
For functions $f_1, f_2$ (even) and $g_1, g_2$ (odd):\\
\textbf{Multiplication}
\begin{enumerate}
    \item $f_1\cdot f_2$ is even
    \item $g_1\cdot g_2$ is even
    \item $f\cdot g$ is odd
\end{enumerate}
\textbf{Addition}
\begin{enumerate}
    \item $f_1+f_2$ is even
    \item $g_1+g_2$ is odd
\end{enumerate}
\textbf{Differentiation}
\begin{enumerate}
    \item $f'$ is odd
    \item $g'$ is even
\end{enumerate}

\subsubsection{Expansion of FS}
If $f(t)$ is defined on $[0,L]$ the expanded function is $2L$ periodic. This method can be used to solve PDEs. \vspace*{8pt}\\
\begin{minipage}[t]{0.18\textwidth}
    \textbf{Copy-paste} exp.\\
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                unit vector ratio={3 1.2},
                axis x line=left,
                axis y line=middle,
                xmin=-2.5,
                xmax=2.5,
                ymin=0,
                ymax=2,
                %xlabel={$t$},
                %ylabel={$u(t-a)$},
                xtick={0},
                ytick={1},
                extra x ticks={-2, 2},
                extra x tick labels={$-L$,$L$},
                mark=none,
            ]
            \addplot [blue, very thick]
            coordinates {
                    %(\pgfkeysvalueof{/pgfplots/xmin},0)
                    (0,1)
                    (1,1)
                };
            \addplot [blue, very thick]
            coordinates {
                    (1,0.05)
                    (2,0.05)
                    %(\pgfkeysvalueof{/pgfplots/xmax},1)
                };
            \addplot [blue, very thick, dotted]
            coordinates {
                    %(\pgfkeysvalueof{/pgfplots/xmin},0)
                    (-2,1)
                    (-1,1)
                };
            \addplot [blue, very thick, dotted]
            coordinates {
                    (-1,0.05)
                    (0,0.05)
                    %(\pgfkeysvalueof{/pgfplots/xmax},1)
                };
            \addplot[fill=white,only marks,mark=*] coordinates{(1,0)(1,1)(0,1)(2,0)(-2,1)(-1,1)(-1,0)(0,0)};
        \end{axis}
    \end{tikzpicture}
\end{minipage}
\begin{minipage}[t]{0.18\textwidth}
    \textbf{Even} expansion\\
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                unit vector ratio={3 1.2},
                axis x line=left,
                axis y line=middle,
                xmin=-2.5,
                xmax=2.5,
                ymin=0,
                ymax=2,
                %xlabel={$t$},
                %ylabel={$u(t-a)$},
                xtick={0},
                ytick={1},
                extra x ticks={-2, 2},
                extra x tick labels={$-L$,$L$},
                mark=none,
            ]
            \addplot [blue, very thick]
            coordinates {
                    %(\pgfkeysvalueof{/pgfplots/xmin},0)
                    (0,1)
                    (1,1)
                };
            \addplot [blue, very thick]
            coordinates {
                    (1,0.05)
                    (2,0.05)
                    %(\pgfkeysvalueof{/pgfplots/xmax},1)
                };
            \addplot [blue, very thick, dotted]
            coordinates {
                    %(\pgfkeysvalueof{/pgfplots/xmin},0)
                    (-1,1)
                    (0,1)
                };
            \addplot [blue, very thick, dotted]
            coordinates {
                    (-2,0.05)
                    (-1,0.05)
                    %(\pgfkeysvalueof{/pgfplots/xmax},1)
                };
            \addplot[fill=white,only marks,mark=*] coordinates{(1,0)(1,1)(0,1)(2,0)(-2,0)(-1,1)(-1,0)(0,0)};
        \end{axis}
    \end{tikzpicture}
\end{minipage}
\begin{minipage}[t]{0.18\textwidth}
    \textbf{Odd} expansion\\
    \begin{tikzpicture}
        \begin{axis}[
                width=\linewidth,
                unit vector ratio={3 1.2},
                axis x line=center,
                axis y line=center,
                xmin=-2.5,
                xmax=2.5,
                ymin=-2,
                ymax=2,
                %xlabel={$t$},
                %ylabel={$u(t-a)$},
                xtick={0},
                ytick={1},
                extra x ticks={-2,2},
                extra x tick labels={$-L$,$L$},
                mark=none,
            ]
            \addplot [blue, very thick]
            coordinates {
                    %(\pgfkeysvalueof{/pgfplots/xmin},0)
                    (0,1)
                    (1,1)
                };
            \addplot [blue, very thick]
            coordinates {
                    (1,0.05)
                    (2,0.05)
                    %(\pgfkeysvalueof{/pgfplots/xmax},1)
                };
            \addplot [blue, very thick, dotted]
            coordinates {
                    %(\pgfkeysvalueof{/pgfplots/xmin},0)
                    (-1,-1)
                    (0,-1)
                };
            \addplot [blue, very thick, dotted]
            coordinates {
                    (-2,-0.05)
                    (-1,-0.05)
                    %(\pgfkeysvalueof{/pgfplots/xmax},1)
                };
            \addplot[fill=white,only marks,mark=*] coordinates{(1,0)(1,1)(0,1)(2,0)(-2,0)(-1,-1)(-1,0)(0,-1)};
        \end{axis}
    \end{tikzpicture}
\end{minipage}

\subsection{Complex Fourier Series}
If $f(t)$ is $2L$-periodic, the \textbf{complex fourier series} is given by:
\begin{equation*}
    f(x)=c_0+\sum_{\overset{n=-\infty}{n\neq0}}^\infty c_n\cdot e^{\frac{i\pi n}Lx}
\end{equation*}
\begin{equation*}
    c_0=\frac1{2L}\int_{-L}^L f(x)dx\quad\mid \quad c_n=\frac1{2L}\int_{-L}^L f(x)\cdot e^{-\frac{i\pi n}Lx}dx
\end{equation*}

Conversion from and to \textbf{real FS}:\\
\begin{tabular}[h]{c|c|c} % chktex -2
    \multicolumn{2}{c}{$a_0=c_0$} & $e^{\pm ix}=\cos x\pm i\sin x$                             \\
    $a_n=c_n+\overline{c_n}$      & $c_n = \frac{1}{2}(a_n-ib_n)$  & $e^{ix}-e^{-ix}=2i\sin x$ \\
    $b_n=i(c_n-\overline{c_n})$   & $c_{-n}=\overline{c_n}$        & $e^{ix}+e^{-ix}=2\cos x$
\end{tabular}

\subsubsection{Minimum Square Error}
The MSE of a trigonometric polynomial of degree $N$ that best approximates a function $f(t)$ on the interval $[-\pi,\pi]$ is:

\begin{align*}
    E^*=\intop_{-\pi}^\pi f^2(x)dx-\pi\left(2a_0^2+\sum_{n=1}^N(a_n^2+b_n^2)\right)
\end{align*}

\subsection{Absolute Integrable}
$f(t)$ is absolutely integrable if:
\begin{align*}
    \int_{-\infty}^{\infty}\left|f(x)\right|dx<\infty ,\quad f\in L_1
\end{align*}
\subsection{Fourier Integral}
The \textbf{Fourier Integral} is defined if $f$ is piecewise continuous, has left/right derivatives at
discontinuities and is absolutely Integrable:
\begin{align*}
    f(t) & =\int_0^\infty[A(w)\cos(wx)+B(w)\sin(wx)]dw     \\\\
    A(w) & =\frac1\pi\int_{-\infty}^{\infty}f(v)\cos(wv)dv \\
    B(w) & =\frac1\pi\int_{-\infty}^{\infty}f(v)\sin(wv)dv
\end{align*}
\textbf{Remark}\\
The convergence properties and behaviour at discontinuities are analogous to the fourier series.
\subsubsection{Even FI}
If $f(t)$ is even, i.e. $f(t)=f(-t)$, the FI simplifies to:
\begin{align*}
    f(x) & =\int_0^\infty A(w)\cos(wx)dw          \\\\
    A(w) & =\frac2\pi\int_0^\infty f(v)\cos(wv)dv \\
    B(w) & =0
\end{align*}
\subsubsection{Odd FI}
If $f(t)$ is odd, i.e. $f(t)=-f(-t)$, the FI simplifies to:
\begin{align*}
    f(x) & =\int_0^\infty B(w)\sin(wx)dw          \\\\
    A(w) & =0                                     \\
    B(w) & =\frac2\pi\int_0^\infty f(v)\sin(wv)dv
\end{align*}

\subsection{Fourier Transform}
If $f$ is absolutely integrable (non-periodic), and piecewise continuous on finite interval,
then the \textbf{Fourier Transform} and its inverse exist:
\begin{align*}
    \mathcal{F}(f)(w)=\widehat{f}(w)      & :=\frac1{\sqrt{2\pi}}\int_{-\infty}^{\infty}f(v)e^{-iwv}dv          \\\\
    \mathcal{F}^{-1}(\widehat{f})(x)=f(x) & :=\frac1{\sqrt{2\pi}}\int_{-\infty}^{\infty}\widehat{f}(w)e^{iwx}dw \\
\end{align*}
\subsubsection{Properties of FT}

\begin{tabular}[h]{p{0.25\linewidth} p{0.65\linewidth}}
    1. Linearity   & $\alpha f+\beta g\;\laplace\;\alpha\widehat{f}+\beta\widehat{g}$                                     \\
                   &                                                                                                      \\
                   &                                                                                                      \\
    \multicolumn{2}{p{0.9\linewidth}}{If $f$ is continuous on $\mathbb{R}$, $\lim_{|x|\to\infty}f(x)=0$ and $f'\in L_1$:} \\
    2. Derivative  & $f^{\prime}(x)\;\laplace\;iw\widehat{f}(w)$                                                          \\
                   &                                                                                                      \\
    \multicolumn{2}{p{0.9\linewidth}}{If $f,g$ are piecewise linear, bounded and $\in L_1$:}                              \\
    3. Convolution & $f*g\;\laplace\;\sqrt{2\pi}\widehat{f}\;\widehat{g}$                                                 \\
\end{tabular}\vspace*{8pt}\\
More properties:
\begin{align*}
    u_t                & \;\laplace\;\frac\partial{\partial t}\hat{u}(\omega,t)     \\
    t^2u_x             & \;\laplace\; t^2\;\widehat{u_x}                            \\
    x^k\cdot f(x)      & \;\laplace\;i^k \frac{\partial^k}{\partial w^k}\widehat{f} \\
    x(t-t_0)           & \;\laplace\; e^{-2\pi ift_0}\;\widehat{x}(f)               \\
    e^{2\pi if_0t}x(t) & \;\laplace\; \widehat{x}(f-f_0)
\end{align*}

\subsubsection{How to Choose}

\def\arraystretch{1.2}

\begin{tabular}[h]{p{0.4\linewidth}|p{0.09\linewidth}|p{0.09\linewidth}|p{0.04\linewidth}|p{0.05\linewidth}|p{0.05\linewidth}} % chktex 44
    Property                    & FS $\mathbb{R}$ & FS $\mathbb{C}$ & FI           & FT           & LT           \\
    \hline % chktex -2
    Periodic                    & \checkmark{}    & \checkmark{}    & x            & x            & x            \\
    $L_1$                       & \checkmark{}    & \checkmark{}    & \checkmark{} & \checkmark{} & x            \\
    Piecewise cont.             & \checkmark{}    & \checkmark{}    & \checkmark{} &              &              \\
    Left/right deriv.\ at disc. & \checkmark{}    & \checkmark{}    & \checkmark{} &              &              \\
    \hline % chktex -2
    \hline % chktex -2
    Advantage                   &                 &                 &              &              &              \\
    Complex eigenfunctions      & x               & \checkmark{}    & x            & \checkmark{} & \checkmark{} \\
    Odd / Even distinction      & \checkmark{}    & x               & \checkmark{} & x            & x
\end{tabular}
\def\arraystretch{1}