\section{Partial Differential Equations}

\subsection{Definition}
A partial differential equation (PDE) is an equation involving an \textbf{unknown function} (in contrast to ODEs only one) and some of its \textbf{partial derivatives}.
\begin{enumerate}
    \item A PDE is called \textbf{linear} if it is linear in the unknown function u and its derivatives.
    \item A linear PDE is called \textbf{homogeneous} if each of its terms contains either the function or one of its derivatives.
    \item The \textbf{order} of a PDE is the order of the highest derivative in the PDE.\@
\end{enumerate}

\subsubsection{Basic Types of PDEs}
\begin{itemize}
    \item 1-dimensional Wave Equation:
          \begin{equation*}
              \frac{\partial ^2 u}{\partial t^2} = c^2\frac{\partial u}{\partial x^2}
          \end{equation*}
          (\textit{linear, 2nd order, homogeneous, hyperbolic})
    \item 1-dimensional Heat Equation:
          \begin{equation*}
              \frac{\partial u}{\partial t} = c^2 \frac{\partial ^2 u}{\partial x^2}
          \end{equation*}
          (\textit{linear, 2nd order, homogeneous, parabolic})
    \item 2-dimensional Laplace Equation:
          \begin{equation*}
              \nabla^2 u=\frac{\partial^2 u}{\partial x^2}+\frac{\partial ^2 u}{\partial y^2}=0
          \end{equation*}
          (\textit{linear, 2nd order, homogeneous, elliptic})
    \item 2-dimensional Poisson Equation:
          \begin{equation*}
              \nabla^2 u=\frac{\partial^2 u}{\partial x^2}+\frac{\partial^2 u}{\partial y^2}=f(x,y)
          \end{equation*}
          (\textit{linear, 2nd order, inhomogeneous, elliptic})
    \item 2-dimensional Wave Equation:
          \begin{equation*}
              \frac{\partial^2u}{\partial t^2}=c^2 \Bigl(\frac{\partial^2 u}{\partial x^2}+\frac{\partial ^2 u}{\partial y^2}\Bigr)=c^2\nabla^2 u
          \end{equation*}
          (\textit{linear, 2nd order, homogeneous, hyperbolic})
    \item 2-dimensional Heat Equation
          \begin{equation*}
              \frac{\partial u}{\partial t}=c^2\Bigl(\frac{\partial^2 u}{\partial x^2}+\frac{\partial ^2 u}{\partial y^2}\Bigr)=c^2\nabla^2 u
          \end{equation*}
          (\textit{linear, 2nd order, homogeneous, parabolic})
    \item 3-dimensional Laplace Equation
          \begin{equation*}
              \nabla^2 u=\frac{\partial^2 u}{\partial x^2}+\frac{\partial ^2 u}{\partial y^2}+\frac{\partial ^2 u}{\partial z^2}=0
          \end{equation*}
          (\textit{linear, 2nd order, homogeneous, elliptic})
\end{itemize}

\subsubsection{Solutions of linear PDEs}
\begin{itemize}
    \item Many functions of a certain form can satisfy the PDE
    \item Uniqueness of solutions is achieved by \textbf{boundary} conditions and \textbf{initial} conditions
\end{itemize}
\vspace{5pt}
\textbf{Superposition Principle}\\
If $u_{1}$ and $u_{2}$ are solutions of a \textbf{homogeneous} (linearity is not enough) PDE, then $\alpha u_{1} + \beta u_{2}$ is also a solution of the same PDE $\forall \alpha , \beta \in \mathbb{R}$

\subsection{2nd Order Linear PDEs}
\subsubsection{General Form of 2nd Order Linear PDE}
A 2nd order linear PDE can be written in the form
\begin{equation*}
    Au_{xx}+2Bu_{xy}+Cu_{yy}=F(x,y,u,u_x,u_y)
\end{equation*}

\subsubsection{Classification by Discriminant}
A 2nd order linear PDE has the discriminant $AC-B^2$ and is called
\begin{enumerate}
    \item \textbf{hyperbolic} (wave), if $AC-B^2<0$
    \item \textbf{parabolic} (heat), if $AC-B^2=0$
    \item \textbf{elliptic} (laplace), if $AC-B^2>0$
\end{enumerate}
\vspace{5pt}
Remarks:
\begin{itemize}
    \item Classification is independent of the PDEs dimension\vspace{5pt}
    \item The type of a PDE depends only on the terms of second order: \textbf{Poisson} equations are also \textbf{elliptic}.
\end{itemize}

\subsection{1D Wave Equation - Fourier Series}
To find $u(x,t)$ satisfying the \textbf{homogeneous} 1D wave equation on $x\in[0,L]$ with \textbf{initial} and
\textbf{boundary} conditions:
\begin{equation*}
    \begin{cases}
        u_{tt}=c^2u_{xx} & \text{PDE} \\
        u(0,t)=u_0       & \text{BC}  \\
        u(L,t)=u_L       & \text{BC}  \\
        u(x,0)=f(x)      & \text{IC}  \\
        u_t(x,0)=g(x)    & \text{IC}
    \end{cases}
\end{equation*}\\
three steps have to be taken:
\begin{itemize}
    \item[(i)] Separation of variables
    \item[(ii)] Finding the ``many'' solution
    \item[(iii)] Finding one solution satisfying IC \& BC
\end{itemize}

\subsubsection{(i) Separation of Variables}
\begin{align*}
    u(x,t)                          & =F(x)G(t)                                               \\
    \underbrace{F\ddot{G}}_{u_{tt}} & =c^2\underbrace{F''G}_{u_{xx}}                          \\
    \frac{\ddot{G}}{c^2G}           & =\frac{F''}{F}=k\hspace*{10pt}\Rightarrow\hspace*{10pt}
    \begin{cases}
        F''=kF \\
        \ddot{G}=c^2kG
    \end{cases}
\end{align*}
\begin{align*}
    u(0,t) & =F(0)G(t)=u_0\mathrm{~}\forall t\geq0\quad\Rightarrow & \mathbf{F(0)}=\mathbf{u_0} \\
    u(L,t) & =F(L)G(t)=u_L\mathrm{~}\forall t\geq0\quad\Rightarrow & \mathbf{F(L)}=\mathbf{u_L}
\end{align*}

\subsubsection{(ii) ``Many'' Solution}
By applying the boundary conditions \textbf{BC}
\begin{align*}
    \mathbf{F(0)} & =\mathbf{u_0} \\
    \mathbf{F(L)} & =\mathbf{u_L}
\end{align*}
into the separated equation
\begin{equation*}
    F''=kF \\
\end{equation*}
$F(x)$ can be found:
\begin{align*}
    F(x)= &
    \begin{cases}
        A_1e^{\sqrt{k}x}+A_2e^{-\sqrt{k}x}      & k>0 \\
        A_1\cos(\sqrt{-k}x)+A_2\sin(\sqrt{-k}x) & k<0 \\
        A_1x+A_2                                & k=0 \\
    \end{cases} \\
\end{align*}
Since $k$ is constant for both $F,G$, $G(t)$ satisfying
\begin{align*}
    \ddot{G}=c^2kG
\end{align*}
can be obtained by:
\begin{align*}
    G(t)= &
    \begin{cases}
        B_1e^{\sqrt{k}t}+B_2e^{-\sqrt{k}t}      & \;\,k>0 \\
        B_1\cos(\sqrt{-k}t)+B_2\sin(\sqrt{-k}t) & \;\,k<0 \\
        B_1t+B_2                                & \;\,k=0
    \end{cases}
\end{align*}

\subsubsection{(iii) Specific Solution}\label{pde/1dwave/specificSolution}
In general, the specific solution can be found by combining the initial conditions \textbf{IC}
with the general solution found in (ii).\\\hbox{}\\
If $\mathbf{u(0,t)=u(L,t)= 0}$ the \textbf{general solution} Ansatz:
\begin{equation*}
    u(x,t)=\sum\limits_{n=1}^{\infty}
    \Bigl( B_n \cos(\lambda _n t)+B_n^* \sin(\lambda_n t)\Bigr) \sin
    \left(\frac{n \pi}{L}x \right)
\end{equation*}\\
can be used, and the \textbf{specific solution} by \textbf{FS} is given by:
\begin{align*}
    \lambda_n & =\frac{c\; n\; \pi}{L}                                               \\
    B_n       & =\frac{2}{L}\int\limits_0^L f(x)\sin(\frac{n\;\pi}{L}x)dx            \\
    B_n^*     & =\frac{2}{L\lambda_n} \int\limits_0^L g(x) \sin(\frac{n\;\pi}{L}x)dx \\\\
    f(x)      & =\sum\limits_{n=1}^{\infty} B_n \sin(\frac{n\;\pi}{L}x)              \\
    g(x)      & =\sum\limits_{n=1}^{\infty} B_n^* \lambda_n \sin(\frac{n\;\pi}{L}x)  \\
\end{align*}
\text{Useful tricks:}
\begin{itemize}
    \item If $f(x),g(x)$ can be written in terms of $\sin(\frac{n\;\pi}{L}x)$, $B_n, B_n^*$
          can be calculated directly
\end{itemize}

\subsubsection{Inhomogeneous Boundary Conditions}
To solve a linear homogeneous 2nd order PDE with inhomogeneous BC, a fitting substitution can be used:
\begin{align*}
     & v(x,t):= u(x,t) -w(x) \\
     & \begin{cases}
           v_{tt}=c^2v_{xx}-w_x \\
           v(0,t)=u(0,t)-w(0)=0 \\
           v(L,t)=u(L,t)-w(L)=0 \\
           v(x,0)=u(x,0)-w(x)   \\
           v_t(x,0)=u_t(x,0)
       \end{cases}
\end{align*}
subsequently, $v(x,t)$ has homogeneous BC.

\begin{examplesection}[Example]
    For the given Problem
    \[ u_{tt}=c^2u_{xx}\]
    we make the Ansatz
    \[u(x,t)=F(x)G(t)\]
    Plugging this into the given PDE and rearranging delivers
    \[u_{tt}=F\ddot{G};\qquad u_{xx}=F''G \quad \rightarrow F\ddot{G}=c^2F''G\]
    \[\frac{\ddot{G}}{c^2G}=\frac{F''}{F}=k\;\; ;\qquad\quad\begin{cases} F''=kF \\
            \ddot{G}=c^2kG
        \end{cases}\]
    as $k$ must be constant. This rearrangement is the purpose of our Ansatz and delivers two ODEs to solve instead of one PDE.
    Inserting the boundary conditions into $F''=kF$ and using a harmonic Ansatz delivers a set of solutions for the BVP of the form
    \[F_n (x)=\sin{\left( \frac{n \pi}{L} x \right) }, \sqrt{-k}=\frac{n \pi}{L}\]
    which satisfy the BVP for negative values of k ($k \ge 0$ yields the $F=0$ solution which is not interesting).\\
    Inserting these values of $k$ into $\ddot{G}=c^2kG$ and using a harmonic Ansatz again delivers a family of solutions
    \[G_n (t) =  B_n \cos{(\lambda_{n} t)} + B_n^* \sin{(\lambda_{n}t)}\]
    where
    \[ \lambda_{n} = \frac{c n \pi}{L} \]
    Inserting $F_n$ and $G_n$ into $u(x,t)=F(x)G(t)$ we obtain a family of solutions for our initial problem of the form
    \[u_n (x, t) = (B_n \cos{(\lambda_{n} t)} + B_n^* \sin{(\lambda_{n}t)})\sin{\left( \frac{n \pi}{L} x \right) } \]
    where $u_n (x, t)$ are called Eigenfunctions and $\lambda_n$ the spectrum.\\
    Using fourier series we can generate a general solution for all $n$ of the form
    \[u(x,t)=\sum\limits_{n=1}^{\infty}\begin{pmatrix}
            B_n \cos(\lambda _n t)+B_n^* \sin(\lambda_n t)
        \end{pmatrix} \sin\left(\frac{n \pi}{L}x \right) \]
    which does not satisfy the IVP in general.\\
    To satisfy the IVP we insert the initial value conditions $u(x,0)=f(x)$ and $u_t(x,0)=g(x)$ from which we obtain the formulas shown in Chapter~\ref{pde/1dwave/specificSolution}.
\end{examplesection}

\subsection{1D Wave Equation - d'Alembert}
The \textit{D'Alembert} solution $u(x,t) = \phi(x+ct)+\psi(x-ct)$ is the general solution of the 1D wave equation $u_{tt}=c^2u_{xx}$ for $x \in \mathbb{R}$ and $t>0$. With the initial conditions
\begin{align*}
    u(x,0)   & = f(x) \\
    u_t(x,0) & = g(x) \\
\end{align*}
the \textit{D'Alembert} solution can be rewritten as following:
\begin{equation*}
    u(x,t)=\frac{1}{2}\left[f(x+ct)+f(x-ct)\right]+\frac{1}{2c}\int_{x-ct}^{x+ct}g(s)ds
\end{equation*}
This form shows, that for a given position $x_i$ and time $t_i$ the result is only depending on the initial position \textcolor{mathGreen}{$f(\cdot)$} at \textcolor{mathGreen}{$x_i\pm ct_i$} and the initial velocity \textcolor{red}{$g(\cdot)$} evaluated over the interval \textcolor{red}{$x_i\pm ct_i$}.
\begin{center}
    \begin{tikzpicture}
        \begin{axis}[
                width=0.8\linewidth,
                unit vector ratio={1 1},
                axis x line=left,
                axis y line=left,
                xmin=0,
                xmax=4,
                ymin=0,
                ymax=1.5,
                xlabel={$x$},
                ylabel={$t$},
                xtick={1,3},
                xticklabels={\textcolor{blue}{$x_i-ct_i$}, \textcolor{blue}{$x_i-ct_i$}},
                ytick={0},
                mark=none,
            ]
            \addplot [blue]
            coordinates {
                    (1,0)
                    (2,1)
                };
            \addplot [blue]
            coordinates {
                    (3,0)
                    (2,1)
                };
            \addplot [red, very thick]
            coordinates {
                    (1,0.01)
                    (3,0.01)
                };
            \addplot[color=mathGreen, fill=mathGreen, only marks,mark=*]
            coordinates{
                    (1,0)
                    (3,0)};
            \node[label={[right,yshift=1ex,xshift=0.3em]:{\textcolor{blue}{($x_i,t_i$)}}},circle,fill=white,draw=blue, thick, inner sep=1pt]
            at (axis cs:2,1) {};
        \end{axis}
    \end{tikzpicture}
\end{center}
If the initial conditions $f(\cdot)$ and $g(\cdot)$ are only non zero on the interval $[a,b]$ the solution of the wave equation can be divided into the following six sectors ($I-VI$).
\includegraphics[width=\linewidth]{../images/pde_dAlembert.png}
where $u(x_i,t_i)$ is
\begin{equation*}
    \begin{cases}
        0,                                                                        & \forall (x_i,t_i) \in I \cup III \\
        \text{full d'Alembert equation}                                           & \forall (x_i,t_i) \in II \cup V  \\
        \frac{1}{2}\left[f(x_i+ct_i)\right]+\frac{1}{2c}\int_{a}^{x_i+ct_i}g(s)ds & \forall (x_i,t_i) \in IV         \\
        \frac{1}{2}\left[f(x_i-ct_i)\right]+\frac{1}{2c}\int_{x_i-ct_i}^{b}g(s)ds & \forall (x_i,t_i) \in VI
    \end{cases}
\end{equation*}


\subsection{Normal form}
With an appropriate change of coordinates a 2nd order linear PDE can be brought into the \textit{normal form}, that is
\begin{align*}
    u_{vw}          & = F^{*}(v,w,u,u_v,u_w) &  & \textit{hyperbolic} \\
    u_{vv}          & = F^{*}(v,w,u,u_v,u_w) &  & \textit{parabolic}  \\
    u_{vv} + u_{ww} & = F^{*}(v,w,u,u_v,u_w) &  & \textit{elliptic}
\end{align*}